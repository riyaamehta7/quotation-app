<!DOCTYPE html>
<html>
<head>
    <title>Create Quotation</title>

    <script>
        function addRow() {
            const table = document.getElementById("items-table");
            const row = table.insertRow(-1);

            row.innerHTML = `
                <td><input name="item[]" required></td>
                <td><input name="qty[]" type="number" min="1" value="1" oninput="calculateTotal()" required></td>
                <td><input name="rate[]" type="number" min="0" value="0" oninput="calculateTotal()" required></td>
                <td><button type="button" onclick="removeRow(this)">❌</button></td>
            `;
        }

        function removeRow(btn) {
            const row = btn.parentNode.parentNode;
            row.remove();
            calculateTotal();
        }

        function calculateTotal() {
            let qtys = document.getElementsByName("qty[]");
            let rates = document.getElementsByName("rate[]");

            let total = 0;

            for (let i = 0; i < qtys.length; i++) {
                let qty = parseFloat(qtys[i].value) || 0;
                let rate = parseFloat(rates[i].value) || 0;
                total += qty * rate;
            }

            let gst = total * 0.18;
            let finalAmount = total + gst;

            document.getElementById("subtotal").innerText = total.toFixed(2);
            document.getElementById("gst").innerText = gst.toFixed(2);
            document.getElementById("final").innerText = finalAmount.toFixed(2);
        }
    </script>
</head>

<body>

<h2>Create Quotation</h2>

<form method="POST">

    <label>Client Name:</label><br>
    <input type="text" name="client" required><br><br>

    <label>Date:</label><br>
    <input type="date" name="date" required><br><br>

    <label>Place of Event:</label><br>
    <input type="text" name="place" required><br><br>

    <h3>Items</h3>

    <table border="1" id="items-table">
        <tr>
            <th>Item</th>
            <th>Qty</th>
            <th>Rate</th>
            <th>Action</th>
        </tr>
        <tr>
            <td><input name="item[]" required></td>
            <td><input name="qty[]" type="number" min="1" value="1" oninput="calculateTotal()" required></td>
            <td><input name="rate[]" type="number" min="0" value="0" oninput="calculateTotal()" required></td>
            <td></td>
        </tr>
    </table>

    <br>
    <button type="button" onclick="addRow()">➕ Add Item</button>

    <br><br>

    <h3>Preview Amount</h3>
    <p><b>Subtotal:</b> ₹ <span id="subtotal">0.00</span></p>
    <p><b>GST (18%):</b> ₹ <span id="gst">0.00</span></p>
    <p><b>Final Amount:</b> ₹ <span id="final">0.00</span></p>

    <br>

    <button type="submit">Generate Quotation PDF</button>

</form>

</body>
</html>
